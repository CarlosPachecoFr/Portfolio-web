---
import AOSWrapper from "../components/AOSWrapper.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/assets/Logo.svg" />
		<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
		<meta name="generator" content={Astro.generator} />
		<title>Carlos Pacheco - Portfolio</title>
	</head>
	<body class="bg-[#F4F5F6]">
		<Header />
		<slot />
		<Footer />
		<AOSWrapper />
		<script>
			document.addEventListener('DOMContentLoaded', () => {

			// Toggle menú hamburguesa
			const menuBtn = document.getElementById('menu-btn');
			const menuMovil = document.getElementById('menu-movil');

			if (menuBtn && menuMovil) {
				const lines = menuBtn.querySelectorAll('span');

				function toggleMenu() {
				if (lines.length === 3) {
					// Transformación de la X
					lines[0].classList.toggle('rotate-45');
					lines[0].classList.toggle('translate-y-2');
					lines[1].classList.toggle('opacity-0');
					lines[2].classList.toggle('-rotate-45');
					lines[2].classList.toggle('-translate-y-2');
				}

				// Animación de altura del menú
				if(menuMovil){
					if (menuMovil.style.maxHeight && menuMovil.style.maxHeight !== '0px') {
						menuMovil.style.maxHeight = '0px';
					} else {
						menuMovil.style.maxHeight = menuMovil.scrollHeight + 'px';
					}
				}
				}

				menuBtn.addEventListener('click', toggleMenu);
			}

			// Nav-link activo y cierre de menú móvil al click
			const links = document.querySelectorAll('.nav-link');
			const sections = document.querySelectorAll('section');

			links.forEach(link => {
				link.addEventListener('click', () => {
				// Remueve clase activa de todos
				links.forEach(l => l.classList.remove(
					'text-[#33CE33]', 
					'drop-shadow-[0_0_8px_rgba(51,206,51,0.6)]'
				));

				// Agrega clase activa al link clicado
				link.classList.add(
					'text-[#33CE33]', 
					'drop-shadow-[0_0_8px_rgba(51,206,51,0.6)]'
				);

				// Cierra el menú móvil si está abierto
				if (menuMovil && menuMovil.style.maxHeight && menuMovil.style.maxHeight !== '0px') {
					menuMovil.style.maxHeight = '0px';
					if (menuBtn) {
					const lines = menuBtn.querySelectorAll('span');
					if (lines.length === 3) {
						lines[0].classList.remove('rotate-45', 'translate-y-2');
						lines[1].classList.remove('opacity-0');
						lines[2].classList.remove('-rotate-45', '-translate-y-2');
					}
					}
				}
				});
			});

			// Cambiar clase activa según scroll
			window.addEventListener('scroll', () => {
				let scrollPos = window.scrollY + 100;
				sections.forEach(section => {
				const top = section.offsetTop;
				const bottom = top + section.offsetHeight;
				const id = section.getAttribute('id');
				const link = document.querySelector(`.nav-link[href="#${id}"]`);
				if (scrollPos >= top && scrollPos < bottom) {
					links.forEach(l => l.classList.remove(
					'text-[#33CE33]', 
					'drop-shadow-[0_0_8px_rgba(51,206,51,0.6)]'
					));
					if (link) {
					link.classList.add(
						'text-[#33CE33]', 
						'drop-shadow-[0_0_8px_rgba(51,206,51,0.6)]'
					);
					}
				}
				});
			});

			});
		</script>
	</body>
</html>